(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{457:function(t,s,a){"use strict";a.r(s);var e=a(7),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"吾爱破解-破解入门学习3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#吾爱破解-破解入门学习3"}},[t._v("#")]),t._v(" 吾爱破解---破解入门学习3")]),t._v(" "),s("p",[t._v("通过call调用的弹窗以及OD的堆栈return返回区来定位，找到关键函数，实现绕过某些弹窗，或修改数据跳转条件")]),t._v(" "),s("p",[t._v("(相比于之前通过具体字符串定位，这种做法好像变得复杂了，不过理解地似乎更深刻了，通过弹窗来定位)")]),t._v(" "),s("h2",{attrs:{id:"题目一-一次call调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#题目一-一次call调用"}},[t._v("#")]),t._v(" 题目一：一次call调用")]),t._v(" "),s("p",[t._v("把目标文件仍到OD，在插件中找到   API断点设置 --\x3e 常用断点设置 --\x3e MessageboxA断点(弹窗)，F9调试，直接点击登录，在OD中指令区和堆栈区已经定位到了第一个弹窗“请输入密码”")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/1.png",alt:"pos"}})]),t._v(" "),s("p",[t._v("右下角的堆栈区可以看到这个MessageboxA弹窗信息，下面有多条return返回，堆栈的性质都了解，那么跟进到第一条返回语句")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/2.png",alt:"return"}})]),t._v(" "),s("p",[t._v("效果和中文搜索引擎效果好像一样...，不管了。往上看实现")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("mov eax,0x1\ntext eax,eax\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/3.png",alt:"data"}})]),t._v(" "),s("p",[t._v("这默认不输账号密码应该是弹的，那么把他改成0，后面代码不管看懂看不懂应该都不弹了，修改后再次调试。不输账号密码已经不弹了。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/4.png",alt:"suc"}})]),t._v(" "),s("p",[t._v("同样，再次调试，不输密码直接登录，前面打的弹窗断点还在，定位到了“错误”的弹窗")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/5.png",alt:"err"}})]),t._v(" "),s("p",[t._v("跟进第一条返回，看到弹窗的判断，成功或失败似乎一定会返回一条，绕过错误的弹窗没有意义了直接把正常的弹出来。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/6.png",alt:"6"}})]),t._v(" "),s("p",[t._v("两种方法。")]),t._v(" "),s("ul",[s("li",[t._v("修改eax值")]),t._v(" "),s("li",[t._v("修改je指令为nop")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/7.png",alt:"1"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/8.png",alt:"2"}})]),t._v(" "),s("h2",{attrs:{id:"题目二-多次call调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#题目二-多次call调用"}},[t._v("#")]),t._v(" 题目二：多次call调用")]),t._v(" "),s("p",[t._v("中文引擎看有几个弹窗提示，弹窗下断点直接梭")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/10.png",alt:"2"}})]),t._v(" "),s("p",[t._v("测试发现第一条，长度限制的弹窗，我们不输密码并不会触发，就不管他了，可有可无")]),t._v(" "),s("p",[t._v("call的第一条return返回定位，看到je指令触发弹窗，把je改成jmp来跳过第一条长度的限制")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/9.png",alt:"1"}})]),t._v(" "),s("p",[t._v("同理把后面的账号密码提示弹窗的je指令也改成jmp，直接跳过")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/11.png",alt:"11"}})]),t._v(" "),s("p",[t._v("最后定位到失败的弹窗。修改je指令为nop，不能修改为jmp，否则就直接弹错误弹窗了")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/12.png",alt:"12"}})]),t._v(" "),s("p",[t._v("最后：我发现je指令前大多都会有一个")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("mov eax,0x1\nje 00XXXXX\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("改eax的值或修改je指令为nop效果是一样的")]),t._v(" "),s("p",[t._v("另一种解法：")]),t._v(" "),s("p",[t._v("把文件开头的jie命令的跳转地址直接修改为成功的弹窗")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/13.png",alt:"13"}})]),t._v(" "),s("p",[t._v("找一下成功call前的一句，记下地址 004015AF")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jie 004015AF\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("修改并调试")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://the0n3.top/medias/reb/14.png",alt:"14"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);