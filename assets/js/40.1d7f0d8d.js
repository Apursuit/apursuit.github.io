(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{402:function(t,a,s){"use strict";s.r(a);var p=s(7),e=Object(p.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"文件上传-buuctf解题记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件上传-buuctf解题记录"}},[t._v("#")]),t._v(" 文件上传-BUUCTF解题记录")]),t._v(" "),a("p",[t._v("题目收集自BUUCTF等平台，如有侵权告知删除")]),t._v(" "),a("h2",{attrs:{id:"极客大挑战-2019-upload-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#极客大挑战-2019-upload-1"}},[t._v("#")]),t._v(" [极客大挑战 2019]Upload 1")]),t._v(" "),a("p",[t._v("题目地址"),a("a",{attrs:{href:"https://buuoj.cn/challenges#%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DUpload",target:"_blank",rel:"noopener noreferrer"}},[t._v("[极客大挑战 2019]Upload 1"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("正常上传一个简单的php文件，会提示不是图片文件")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("# 1.php\n"),a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("phpinfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("先从最简单的开始，尝试BP抓包修改报文中MIME类型，放行。又提示上传的是PHP文件，换一个不常见的扩展名.phtml，提示匹配到了<?")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://the0n3.top/medias/upload-practise/1.png",alt:"1"}})]),t._v(" "),a("p",[t._v("换成js脚本的写法")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1.phtml")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script language"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'php'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("phpinfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("提示上传失败，检测到不是图片文件，给他加个图片文件头的特征")]),t._v(" "),a("p",[t._v("参考"),a("a",{attrs:{href:"https://blog.csdn.net/weixin_62715196/article/details/132279908",target:"_blank",rel:"noopener noreferrer"}},[t._v("图片文件头"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1.phtml")]),t._v("\nGIF89a\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script language"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'php'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("phpinfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://the0n3.top/medias/upload-practise/2.png",alt:"2"}})]),t._v(" "),a("p",[t._v("再次上传成功,访问url/upload/1.phtml看到phpinfo()函数执行")]),t._v(" "),a("h2",{attrs:{id:"actf2020-新生赛-upload-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#actf2020-新生赛-upload-1"}},[t._v("#")]),t._v(" [ACTF2020 新生赛]Upload 1")]),t._v(" "),a("p",[t._v("题目地址"),a("a",{attrs:{href:"https://buuoj.cn/challenges#%5BACTF2020%20%E6%96%B0%E7%94%9F%E8%B5%9B%5DUpload",target:"_blank",rel:"noopener noreferrer"}},[t._v("[ACTF2020 新生赛]Upload 1"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("正常上传php文件，js弹出只能上传图片")]),t._v(" "),a("p",[t._v("禁用js，我用chrome插件禁用js")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://the0n3.top/medias/upload-practise/3.png",alt:"3"}})]),t._v(" "),a("p",[t._v("禁用后，php文件还是上传不了，php3，php5也不行，尝试上传一个phtml文件")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("# 1.phtml\n"),a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("phpinfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("上传后访问，phpinfo()函数执行")]),t._v(" "),a("h2",{attrs:{id:"mrctf2020-你传你🐎呢-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mrctf2020-你传你🐎呢-1"}},[t._v("#")]),t._v(" [MRCTF2020]你传你🐎呢 1")]),t._v(" "),a("p",[t._v("题目地址"),a("a",{attrs:{href:"https://buuoj.cn/challenges#%5BMRCTF2020%5D%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2",target:"_blank",rel:"noopener noreferrer"}},[t._v("[MRCTF2020]你传你🐎呢 1"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("传php文件都失败了，看样子只能用图片了。上传.htacess文件失败，修改MIME类型，.htacesss文件上传成功。")]),t._v(" "),a("div",{staticClass:"language-htacess line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# .htacess\nAddType application/x-httpd-php .png\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("blockquote",[a("p",[t._v('".htaccess" 文件是 Apache Web 服务器特有的文件，用于配置服务器的行为。通过 ".htaccess" 文件，用户可以在特定目录中覆盖 Apache 服务器的全局配置，包括重定向、认证、缓存控制等。')])]),t._v(" "),a("p",[t._v("接着上传图片")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("# 1.png\n"),a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("phpinfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("上传成功，访问看到phpinfo()函数执行")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://the0n3.top/medias/upload-practise/5.png",alt:"5"}})]),t._v(" "),a("h2",{attrs:{id:"gxyctf2019-babyupload-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gxyctf2019-babyupload-1"}},[t._v("#")]),t._v(" [GXYCTF2019]BabyUpload 1")]),t._v(" "),a("p",[t._v("题目地址"),a("a",{attrs:{href:"https://buuoj.cn/challenges#%5BGXYCTF2019%5DBabyUpload",target:"_blank",rel:"noopener noreferrer"}},[t._v("[GXYCTF2019]BabyUpload 1"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("上传php文件提示不能上传后缀名有ph的文件，这题看来要用图片。上传png，gif图片失败，修改MIME类型也不能上传，最后看大佬博客发现只能用jpeg")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/weixin_47055136/article/details/131291140",target:"_blank",rel:"noopener noreferrer"}},[t._v("【CTF】[GXYCTF 2019]BabyUpload"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/2302_79800344/article/details/136428034",target:"_blank",rel:"noopener noreferrer"}},[t._v("[GXYCTF2019]BabyUpload1 -- 题目分析与详解"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("最后BP抓包MIME类型修改为image/jpeg竟然上传成功了。")]),t._v(" "),a("p",[t._v("上传.htacess文件")]),t._v(" "),a("div",{staticClass:"language-htacess line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# .htacess\nAddType application/x-httpd-php .png\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("上传png图片")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("# 1.png\n"),a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("phpinfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("提示还是php文件，尝试使用js格式")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1.png")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script language"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'php'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("phpinfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("上传成功，访问看到phpinfo()函数执行")])])}),[],!1,null,null,null);a.default=e.exports}}]);